var microsoftTeams; !function (t) { "use strict"; function e() { if (!R) { R = !0, O = this._window || window; var t = function (t) { return m(t) }; O.addEventListener("message", t, !1), U = O.parent !== O.self ? O.parent : O.opener; try { L = "*"; var e = S(U, "initialize", [D]); Y[e] = function (t, e) { B = t, M = e } } finally { L = null } this._uninitialize = function () { B && (i(null), a(null), s(null)), B === _.settings && J.registerOnSaveHandler(null), B === _.remove && J.registerOnRemoveHandler(null), R = !1, U = null, L = null, j = [], F = null, x = null, V = [], X = 0, Y = {}, B = null, M = null, O.removeEventListener("message", t, !1) } } } function n(t) { p(); var e = S(U, "getContext"); Y[e] = t } function i(t) { p(), z = t } function o(t) { z && z(t), F && S(F, "themeChange", [t]) } function a(t) { p(), q = t } function r(t) { q && q(t) } function s(t) { p(), G = t } function c() { G && G() || u() } function u() { p(); var t = S(U, "navigateBack", []); Y[t] = function (t) { if (!t) throw new Error("Back navigation is not supported in the current client or context.") } } function l(t) { p(_.content, _.settings, _.remove); var e = S(U, "navigateCrossDomain", [t]); Y[e] = function (t) { if (!t) throw new Error("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.") } } function f(t, e) { p(); var n = S(U, "getTabInstances", [e]); Y[n] = t } function h(t, e) { p(); var n = S(U, "getMruTabInstances", [e]); Y[n] = t } function d(t) { p(_.content), S(U, "shareDeepLink", [t.subEntityId, t.subEntityLabel, t.subEntityWebUrl]) } function v(t) { p(_.content), S(U, "openFilePreview", [t.entityId, t.title, t.description, t.type, t.objectUrl, t.downloadUrl, t.webPreviewUrl, t.webEditUrl]) } function g(t) { p(); var e = S(U, "navigateToTab", [t]); Y[e] = function (t) { if (!t) throw new Error("Invalid internalTabInstanceId and/or channelId were/was provided") } } function p() { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; if (!R) throw new Error("The library has not yet been initialized"); if (B && t && t.length > 0) { for (var n = !1, i = 0; i < t.length; i++)if (t[i] === B) { n = !0; break } if (!n) throw new Error("This call is not allowed in the '" + B + "' context") } } function m(t) { if (t && t.data && "object" == typeof t.data) { var e = t.source || t.originalEvent.source, n = t.origin || t.originalEvent.origin; e === O || n !== O.location.origin && A.indexOf(n.toLowerCase()) === -1 || (y(e, n), e === U ? b(t) : e === F && w(t)) } } function y(t, e) { U && t !== U ? F && t !== F || (F = t, x = e) : (U = t, L = e), U && U.closed && (U = null, L = null), F && F.closed && (F = null, x = null), T(U), T(F) } function b(t) { if ("id" in t.data) { var e = t.data, n = Y[e.id]; n && (n.apply(null, e.args), delete Y[e.id]) } else if ("func" in t.data) { var e = t.data, i = W[e.func]; i && i.apply(this, e.args) } } function w(t) { if ("id" in t.data && "func" in t.data) { var e = t.data, n = W[e.func]; if (n) { var i = n.apply(this, e.args); i && I(F, e.id, Array.isArray(i) ? i : [i]) } else { var o = S(U, e.func, e.args); Y[o] = function () { for (var t = [], n = 0; n < arguments.length; n++)t[n] = arguments[n]; F && I(F, e.id, t) } } } } function k(t) { return t === U ? j : t === F ? V : [] } function C(t) { return t === U ? L : t === F ? x : null } function T(t) { for (var e = C(t), n = k(t); t && e && n.length > 0;)t.postMessage(n.shift(), e) } function E(t, e) { var n = O.setInterval(function () { 0 === k(t).length && (clearInterval(n), e()) }, 100) } function S(t, e, n) { var i = N(e, n), o = C(t); return t && o ? t.postMessage(i, o) : k(t).push(i), i.id } function I(t, e, n) { var i = H(e, n), o = C(t); t && o && t.postMessage(i, o) } function N(t, e) { return { id: X++, func: t, args: e || [] } } function H(t, e) { return { id: t, args: e || [] } } var O, U, L, F, x, B, M, z, D = "1.2", A = ["https://teams.microsoft.com", "https://teams.microsoft.us", "https://int.teams.microsoft.com", "https://devspaces.skype.com", "https://ssauth.skype.com", "http://dev.local"], W = {}, _ = { settings: "settings", content: "content", authentication: "authentication", remove: "remove" }, P = { desktop: "desktop", web: "web" }, R = !1, j = [], V = [], X = 0, Y = {}; W.themeChange = o; var q; W.fullScreenChange = r; var G; W.backButtonPress = c, t.initialize = e, t.getContext = n, t.registerOnThemeChangeHandler = i, t.registerFullScreenHandler = a, t.registerBackButtonHandler = s, t.navigateBack = u, t.navigateCrossDomain = l, t.getTabInstances = f, t.getMruTabInstances = h, t.shareDeepLink = d, t.openFilePreview = v, t.navigateToTab = g; var J; !function (t) { function e(t) { p(_.settings, _.remove), S(U, "settings.setValidityState", [t]) } function n(t) { p(_.settings, _.remove); var e = S(U, "settings.getSettings"); Y[e] = t } function i(t) { p(_.settings), S(U, "settings.setSettings", [t]) } function o(t) { p(_.settings), c = t } function a(t) { p(_.remove), u = t } function r(t) { var e = new l(t); c ? c(e) : e.notifySuccess() } function s() { var t = new f; u ? u(t) : t.notifySuccess() } var c, u; W["settings.save"] = r, W["settings.remove"] = s, t.setValidityState = e, t.getSettings = n, t.setSettings = i, t.registerOnSaveHandler = o, t.registerOnRemoveHandler = a; var l = function () { function t(t) { this.notified = !1, this.result = t ? t : {} } return t.prototype.notifySuccess = function () { this.ensureNotNotified(), S(U, "settings.save.success"), this.notified = !0 }, t.prototype.notifyFailure = function (t) { this.ensureNotNotified(), S(U, "settings.save.failure", [t]), this.notified = !0 }, t.prototype.ensureNotNotified = function () { if (this.notified) throw new Error("The SaveEvent may only notify success or failure once.") }, t }(), f = function () { function t() { this.notified = !1 } return t.prototype.notifySuccess = function () { this.ensureNotNotified(), S(U, "settings.remove.success"), this.notified = !0 }, t.prototype.notifyFailure = function (t) { this.ensureNotNotified(), S(U, "settings.remove.failure", [t]), this.notified = !0 }, t.prototype.ensureNotNotified = function () { if (this.notified) throw new Error("The removeEvent may only notify success or failure once.") }, t }() }(J = t.settings || (t.settings = {})); var K; !function (t) { function e(t) { g = t } function n(t) { var e = void 0 !== t ? t : g; if (p(_.content, _.settings, _.remove), M === P.desktop) { var n = document.createElement("a"); n.href = e.url; var i = S(U, "authentication.authenticate", [n.href, e.width, e.height]); Y[i] = function (t, n) { t ? e.successCallback(n) : e.failureCallback(n) } } else r(e) } function i(t) { p(); var e = S(U, "authentication.getAuthToken", [t.resources]); Y[e] = function (e, n) { e ? t.successCallback(n) : t.failureCallback(n) } } function o(t) { p(); var e = S(U, "authentication.getUser"); Y[e] = function (e, n) { e ? t.successCallback(n) : t.failureCallback(n) } } function a() { s(); try { F && F.close() } finally { F = null, x = null } } function r(t) { g = t, a(); var e = g.width || 600, n = g.height || 400; e = Math.min(e, O.outerWidth - 400), n = Math.min(n, O.outerHeight - 200); var i = document.createElement("a"); i.href = g.url; var o = "undefined" != typeof O.screenLeft ? O.screenLeft : O.screenX, r = "undefined" != typeof O.screenTop ? O.screenTop : O.screenY; o += O.outerWidth / 2 - e / 2, r += O.outerHeight / 2 - n / 2, F = O.open(i.href, "_blank", "toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top=" + r + ", left=" + o + ", width=" + e + ", height=" + n), F ? c() : h("FailedToOpenWindow") } function s() { m && (clearInterval(m), m = 0), delete W.initialize, delete W.navigateCrossDomain } function c() { s(), m = O.setInterval(function () { if (!F || F.closed) h("CancelledByUser"); else { var t = x; try { x = "*", S(F, "ping") } finally { x = t } } }, 100), W.initialize = function () { return [_.authentication, M] }, W.navigateCrossDomain = function (t) { return !1 } } function u(t, e) { d(e, "result", t), p(_.authentication), S(U, "authentication.authenticate.success", [t]), E(U, function () { return O.close() }) } function l(t, e) { d(e, "reason", t), p(_.authentication), S(U, "authentication.authenticate.failure", [t]), E(U, function () { return O.close() }) } function f(t) { try { g && g.successCallback && g.successCallback(t) } finally { g = null, a() } } function h(t) { try { g && g.failureCallback && g.failureCallback(t) } finally { g = null, a() } } function d(t, e, n) { if (t) { var i = document.createElement("a"); i.href = decodeURIComponent(t), i.host && i.host !== window.location.host && "outlook.office.com" === i.host && i.search.indexOf("client_type=Win32_Outlook") > -1 && (e && "result" === e && (n && (i.href = v(i.href, "result", n)), O.location.assign(v(i.href, "authSuccess", ""))), e && "reason" === e && (n && (i.href = v(i.href, "reason", n)), O.location.assign(v(i.href, "authFailure", "")))) } } function v(t, e, n) { var i = t.indexOf("#"), o = i === -1 ? "#" : t.substr(i); return o = o + "&" + e + ("" !== n ? "=" + n : ""), t = i === -1 ? t : t.substr(0, i), t + o } var g, m; W["authentication.authenticate.success"] = f, W["authentication.authenticate.failure"] = h, t.registerAuthenticationHandlers = e, t.authenticate = n, t.getAuthToken = i, t.getUser = o, t.notifySuccess = u, t.notifyFailure = l }(K = t.authentication || (t.authentication = {})) }(microsoftTeams || (microsoftTeams = {}));
